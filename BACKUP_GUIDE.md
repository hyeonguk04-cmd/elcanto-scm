# ğŸ”’ Firebase ë°ì´í„° ë°±ì—… ê°€ì´ë“œ

## âš¡ ë¹ ë¥¸ ì‹œì‘

### 1. ì„œë¹„ìŠ¤ ê³„ì • í‚¤ ì¤€ë¹„

1. **Firebase Console ì ‘ì†**
   - https://console.firebase.google.com/
   - í”„ë¡œì íŠ¸ ì„ íƒ: `elcanto-scm`

2. **ì„œë¹„ìŠ¤ ê³„ì • í‚¤ ìƒì„±**
   ```
   í”„ë¡œì íŠ¸ ì„¤ì • (âš™ï¸) â†’ ì„œë¹„ìŠ¤ ê³„ì • â†’ ìƒˆ ë¹„ê³µê°œ í‚¤ ìƒì„±
   ```

3. **íŒŒì¼ ì €ì¥**
   - ë‹¤ìš´ë¡œë“œí•œ JSON íŒŒì¼ì„ `firebase-service-account.json`ìœ¼ë¡œ ì´ë¦„ ë³€ê²½
   - í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ì €ì¥
   ```
   webapp/
   â”œâ”€â”€ firebase-service-account.json  â† ì—¬ê¸°!
   â”œâ”€â”€ scripts/
   â””â”€â”€ backups/
   ```

### 2. ë°±ì—… ì‹¤í–‰

```bash
npm run backup
```

ë˜ëŠ”

```bash
node scripts/backup.js
```

### 3. ë³µêµ¬ ì‹¤í–‰

```bash
# 1. ì‚¬ìš© ê°€ëŠ¥í•œ ë°±ì—… í™•ì¸
ls -l backups/

# 2. ë³µêµ¬ (ê¸°ì¡´ ë°ì´í„°ì™€ ë³‘í•©)
npm run restore backups/2025-01-07_14-30-00

# ë˜ëŠ”
node scripts/restore.js backups/2025-01-07_14-30-00
```

---

## ğŸ“‹ **ê°œë°œ ì‘ì—… ì‹œ ë°±ì—… í”„ë¡œì„¸ìŠ¤**

### âœ… **ê¶Œì¥ ì›Œí¬í”Œë¡œìš°**

```bash
# Step 1: ê°œë°œ ì „ ë°±ì—…
npm run backup

# Step 2: ë¸Œëœì¹˜ ìƒì„±
git checkout -b feature/new-feature

# Step 3: ê°œë°œ ì‘ì—…
# ... ì½”ë“œ ìˆ˜ì • ...

# Step 4: í…ŒìŠ¤íŠ¸
# ... ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ...

# Step 5: ë¬¸ì œ ë°œìƒ ì‹œ ë³µêµ¬
npm run restore backups/2025-01-07_14-30-00

# Step 6: ì •ìƒ ì‘ë™ í™•ì¸ í›„ ì»¤ë°‹
git add .
git commit -m "feat: ìƒˆ ê¸°ëŠ¥ ì¶”ê°€"
git push origin feature/new-feature
```

---

## ğŸ—“ï¸ **ë°±ì—… ì‹œë‚˜ë¦¬ì˜¤ë³„ ê°€ì´ë“œ**

### **ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸´ê¸‰ ë°±ì—… (ì§€ê¸ˆ ë‹¹ì¥)**

```bash
# ë°±ì—… ì‹¤í–‰
npm run backup

# ê²°ê³¼ í™•ì¸
ls -lh backups/
```

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 5-10ì´ˆ  
**ê²°ê³¼:** `backups/2025-01-07_14-30-00/` ë””ë ‰í† ë¦¬ ìƒì„±

---

### **ì‹œë‚˜ë¦¬ì˜¤ 2: ëŒ€ê·œëª¨ ì—…ë°ì´íŠ¸ ì „**

```bash
# 1. ë°±ì—…
npm run backup

# 2. ë°±ì—… í™•ì¸
cat backups/2025-01-07_14-30-00/metadata.json

# 3. ê°œë°œ ì§„í–‰
# ...

# 4. ë¬¸ì œ ë°œìƒ ì‹œ
# 4-1. í…ŒìŠ¤íŠ¸ ë³µêµ¬ (DRY RUN)
node scripts/restore.js backups/2025-01-07_14-30-00 --dry-run

# 4-2. ì‹¤ì œ ë³µêµ¬
node scripts/restore.js backups/2025-01-07_14-30-00
```

---

### **ì‹œë‚˜ë¦¬ì˜¤ 3: ë°ì´í„° ì†ì‹¤ ë³µêµ¬**

```bash
# 1. ê°€ì¥ ìµœê·¼ ë°±ì—… ì°¾ê¸°
ls -lt backups/ | head -5

# 2. ë©”íƒ€ë°ì´í„° í™•ì¸
cat backups/2025-01-07_14-30-00/metadata.json

# 3. ë³µêµ¬ (MERGE ëª¨ë“œ - ì•ˆì „)
node scripts/restore.js backups/2025-01-07_14-30-00

# ë˜ëŠ” ì „ì²´ êµì²´ (FORCE ëª¨ë“œ - ì£¼ì˜)
node scripts/restore.js backups/2025-01-07_14-30-00 --force
```

---

## ğŸ“Š **ë°±ì—… íŒŒì¼ êµ¬ì¡°**

```
backups/
â”œâ”€â”€ 2025-01-07_14-30-00/           # ë°±ì—… ë””ë ‰í† ë¦¬ (íƒ€ì„ìŠ¤íƒ¬í”„)
â”‚   â”œâ”€â”€ orders.json                # ë°œì£¼ ë°ì´í„° (2ê±´)
â”‚   â”œâ”€â”€ suppliers.json             # ìƒì‚°ì—…ì²´ ë°ì´í„° (5ê±´)
â”‚   â”œâ”€â”€ users.json                 # ì‚¬ìš©ì ë°ì´í„° (3ê±´)
â”‚   â”œâ”€â”€ processes.json             # ê³µì • ë°ì´í„° (0ê±´, legacy)
â”‚   â””â”€â”€ metadata.json              # ë°±ì—… ë©”íƒ€ì •ë³´
â”œâ”€â”€ 2025-01-06_09-15-23/
â””â”€â”€ 2025-01-05_18-45-12/
```

### **metadata.json ì˜ˆì‹œ:**
```json
{
  "timestamp": "2025-01-07T14:30:00.000Z",
  "collections": [
    { "collection": "orders", "count": 2, "success": true },
    { "collection": "suppliers", "count": 5, "success": true },
    { "collection": "users", "count": 3, "success": true },
    { "collection": "processes", "count": 0, "success": true }
  ],
  "totalDocuments": 10
}
```

---

## ğŸ›¡ï¸ **ë°ì´í„° ë³´í˜¸ ì²´í¬ë¦¬ìŠ¤íŠ¸**

### **ê°œë°œ ì‘ì—… ì „**
- [ ] ë°±ì—… ì‹¤í–‰ ì™„ë£Œ
- [ ] ë°±ì—… íŒŒì¼ ìƒì„± í™•ì¸ (`ls backups/`)
- [ ] ë©”íƒ€ë°ì´í„° í™•ì¸ (`cat backups/.../metadata.json`)
- [ ] ë°±ì—… ë””ë ‰í† ë¦¬ ì´ë¦„ ê¸°ë¡

### **ê°œë°œ ì‘ì—… ì¤‘**
- [ ] Git ë¸Œëœì¹˜ì—ì„œ ì‘ì—…
- [ ] ì •ê¸°ì ìœ¼ë¡œ ì»¤ë°‹
- [ ] ê¸°ëŠ¥ë³„ë¡œ í…ŒìŠ¤íŠ¸

### **ë°°í¬ ì „**
- [ ] ìµœì¢… ë°±ì—… ì‹¤í–‰
- [ ] í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ê²€ì¦
- [ ] ë³µêµ¬ ê³„íš ì¤€ë¹„

---

## âš ï¸ **ì£¼ì˜ì‚¬í•­**

### **ë°±ì—… ê´€ë ¨**
1. â±ï¸ **ë°±ì—… ì†Œìš” ì‹œê°„**
   - í˜„ì¬ ë°ì´í„°(10ê±´): ~5ì´ˆ
   - 300ê±´ ì˜ˆìƒ: ~30-60ì´ˆ

2. ğŸ’° **Firebase ë¹„ìš©**
   - ì½ê¸°: ë¬¸ì„œë‹¹ 1íšŒ
   - ë¬´ë£Œ í• ë‹¹ëŸ‰: 50,000 ì½ê¸°/ì¼
   - í˜„ì¬ ì‚¬ìš©ëŸ‰ ì˜í–¥ ì—†ìŒ

3. ğŸ’¾ **ì €ì¥ ê³µê°„**
   - JSON íŒŒì¼ í¬ê¸°: ë°ì´í„°ëŸ‰ì— ë¹„ë¡€
   - ì˜ˆìƒ: ë°±ì—…ë‹¹ 1-5MB

### **ë³µêµ¬ ê´€ë ¨**
1. âš ï¸ **FORCE ëª¨ë“œ ìœ„í—˜**
   ```bash
   # ìœ„í—˜: ê¸°ì¡´ ë°ì´í„° ëª¨ë‘ ì‚­ì œ!
   node scripts/restore.js backups/... --force
   ```
   - ë°˜ë“œì‹œ ë°±ì—… í›„ ì‚¬ìš©
   - í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ì‹œë„

2. âœ… **MERGE ëª¨ë“œ ê¶Œì¥**
   ```bash
   # ì•ˆì „: ê¸°ì¡´ ë°ì´í„°ì™€ ë³‘í•©
   node scripts/restore.js backups/...
   ```
   - ê°™ì€ IDëŠ” ë°±ì—… ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
   - ìƒˆ IDëŠ” ì¶”ê°€

---

## ğŸ” **ë¬¸ì œ í•´ê²°**

### **Q: ë°±ì—…ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**

**A: ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:**

1. `firebase-service-account.json` íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸
   ```bash
   ls -l firebase-service-account.json
   ```

2. Node.jsê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   ```bash
   node --version  # v14 ì´ìƒ í•„ìš”
   ```

3. firebase-adminì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   ```bash
   npm list firebase-admin
   
   # ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ë‹¤ë©´
   npm install firebase-admin
   ```

---

### **Q: ë³µêµ¬ í›„ ë°ì´í„°ê°€ ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**

**A: ë‹¤ìŒì„ ì‹œë„í•˜ì„¸ìš”:**

1. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ (Ctrl + Shift + R)
2. Firebase Consoleì—ì„œ ë°ì´í„° í™•ì¸
3. ë³µêµ¬ ë¡œê·¸ì—ì„œ ì˜¤ë¥˜ í™•ì¸

---

### **Q: ë°±ì—… íŒŒì¼ì´ ë„ˆë¬´ ë§ì•„ì¡ŒìŠµë‹ˆë‹¤**

**A: ì˜¤ë˜ëœ ë°±ì—… ì •ë¦¬:**

```bash
# 30ì¼ ì´ìƒ ë°±ì—… ì‚­ì œ
find backups/ -type d -mtime +30 -name "20*" -exec rm -rf {} \;

# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œ
rm -rf backups/2024-12-*
```

---

## ğŸ“ **ì§€ì›**

ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´:

1. `scripts/README.md` ìƒì„¸ ë¬¸ì„œ ì°¸ê³ 
2. Firebase Consoleì—ì„œ ì„œë¹„ìŠ¤ ê³„ì • ê¶Œí•œ í™•ì¸
3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸

---

## âœ… **ë°±ì—… ì„±ê³µ ì²´í¬ë¦¬ìŠ¤íŠ¸**

ë°±ì—… ì‹¤í–‰ í›„ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] âœ… "ë°±ì—… ì™„ë£Œ!" ë©”ì‹œì§€ ì¶œë ¥
- [ ] âœ… `backups/YYYY-MM-DD_HH-mm-ss/` ë””ë ‰í† ë¦¬ ìƒì„±
- [ ] âœ… 4ê°œ JSON íŒŒì¼ ìƒì„± (orders, suppliers, users, processes)
- [ ] âœ… metadata.jsonì— ì˜¬ë°”ë¥¸ ë¬¸ì„œ ìˆ˜ ê¸°ë¡
- [ ] âœ… íŒŒì¼ í¬ê¸°ê°€ 0ë³´ë‹¤ í¼

ëª¨ë“  í•­ëª©ì´ ì²´í¬ë˜ë©´ ë°±ì—… ì„±ê³µ! ğŸ‰
