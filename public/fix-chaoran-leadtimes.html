<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì± ì˜¤ë€ ë¦¬ë“œíƒ€ì„ ìˆ˜ì •</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2563eb;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    th {
      background: #f8f9fa;
      font-weight: 600;
      color: #374151;
    }
    .old-value {
      color: #dc2626;
      text-decoration: line-through;
    }
    .new-value {
      color: #059669;
      font-weight: 600;
    }
    .same-value {
      color: #6b7280;
    }
    button {
      background: #2563eb;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
    }
    button:hover {
      background: #1d4ed8;
    }
    button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      display: none;
    }
    .result.success {
      background: #d1fae5;
      color: #065f46;
      border: 1px solid #10b981;
      display: block;
    }
    .result.error {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #ef4444;
      display: block;
    }
    .warning {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      color: #92400e;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”§ ì± ì˜¤ë€ ìƒì‚°ì—…ì²´ ë¦¬ë“œíƒ€ì„ ìˆ˜ì •</h1>
    <p class="subtitle">UI í‘œì‹œ ê°’ê³¼ Firebase ë°ì´í„°ë¥¼ ì¼ì¹˜ì‹œí‚µë‹ˆë‹¤.</p>

    <div class="warning">
      <strong>âš ï¸ ì£¼ì˜ì‚¬í•­:</strong>
      <ul style="margin: 10px 0 0 20px;">
        <li>ì´ ì‘ì—…ì€ Firebaseì˜ <code>/suppliers/chaoran</code> ë¬¸ì„œë¥¼ ì§ì ‘ ìˆ˜ì •í•©ë‹ˆë‹¤.</li>
        <li>ë¡œê·¸ì¸í•œ ìƒíƒœì—ì„œ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.</li>
        <li>ìˆ˜ì • ì „ F12 â†’ Consoleì—ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      </ul>
    </div>

    <h3>ğŸ“Š ë³€ê²½ ì˜ˆì • ë‚´ì—­</h3>
    <table>
      <thead>
        <tr>
          <th>ê³µì •</th>
          <th>í˜„ì¬ Firebase</th>
          <th>ë³€ê²½ í›„ (UI ê¸°ì¤€)</th>
          <th>ë³€ê²½ ì—¬ë¶€</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>ìì¬ (material)</td>
          <td class="old-value">26ì¼</td>
          <td class="new-value">21ì¼</td>
          <td>âœ… ë³€ê²½</td>
        </tr>
        <tr>
          <td>í•œë„CFM (hando_cfm)</td>
          <td class="same-value">15ì¼</td>
          <td class="same-value">15ì¼</td>
          <td>â¸ï¸ ìœ ì§€</td>
        </tr>
        <tr>
          <td>ì œê°‘&ì¡°ë¦½ (cutting_upper)</td>
          <td class="old-value">33ì¼</td>
          <td class="new-value">17ì¼</td>
          <td>âœ… ë³€ê²½</td>
        </tr>
        <tr>
          <td>ê³µì¥ì¶œê³  (factory_shipment)</td>
          <td class="old-value">5ì¼</td>
          <td class="new-value">4ì¼</td>
          <td>âœ… ë³€ê²½</td>
        </tr>
        <tr>
          <td>ì„ ì  (shipping)</td>
          <td class="old-value">4ì¼</td>
          <td class="new-value">3ì¼</td>
          <td>âœ… ë³€ê²½</td>
        </tr>
        <tr>
          <td>ì…í•­ (arrival)</td>
          <td class="old-value">35ì¼</td>
          <td class="new-value">8ì¼</td>
          <td>âœ… ë³€ê²½</td>
        </tr>
      </tbody>
    </table>

    <button id="updateBtn" onclick="updateLeadTimes()">ğŸš€ ë¦¬ë“œíƒ€ì„ ì—…ë°ì´íŠ¸ ì‹¤í–‰</button>

    <div id="result" class="result"></div>
  </div>

  <script type="module">
    // Firebase ì„¤ì • (ê¸°ì¡´ config ì‚¬ìš©)
    const firebaseConfig = {
      apiKey: "AIzaSyAT95g8yR6RBuGcf30tXv9NwH0kkEBwn6k",
      authDomain: "elcanto-scm.firebaseapp.com",
      projectId: "elcanto-scm",
      storageBucket: "elcanto-scm.firebasestorage.app",
      messagingSenderId: "1015941864588",
      appId: "1:1015941864588:web:2e1d3f83a30be6ec81e07f"
    };

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    window.db = firebase.firestore();

    window.updateLeadTimes = async function() {
      const btn = document.getElementById('updateBtn');
      const result = document.getElementById('result');
      
      btn.disabled = true;
      btn.textContent = 'â³ ì—…ë°ì´íŠ¸ ì¤‘...';
      result.style.display = 'none';
      
      try {
        console.log('ğŸ”§ ì± ì˜¤ë€ ìƒì‚°ì—…ì²´ ë¦¬ë“œíƒ€ì„ ìˆ˜ì • ì‹œì‘...');
        
        const chaoranRef = window.db.collection('suppliers').doc('chaoran');
        const doc = await chaoranRef.get();
        
        if (!doc.exists) {
          throw new Error('chaoran ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        }
        
        console.log('ğŸ“¦ í˜„ì¬ leadTimes:', doc.data().leadTimes);
        
        // UI í‘œì‹œê°’ê³¼ ì¼ì¹˜ì‹œí‚´
        const updatedLeadTimes = {
          material: 21,           // ìì¬ (ê¸°ì¡´: 26)
          hando_cfm: 15,          // í•œë„CFM (ê¸°ì¡´: 15, ìœ ì§€)
          cutting_upper: 17,      // ì œê°‘&ì¡°ë¦½ (ê¸°ì¡´: 33)
          factory_shipment: 4,    // ê³µì¥ì¶œê³  (ê¸°ì¡´: 5)
          shipping: 3,            // ì„ ì  (ê¸°ì¡´: 4)
          arrival: 8              // ì…í•­ (ê¸°ì¡´: 35)
        };
        
        await chaoranRef.update({
          leadTimes: updatedLeadTimes
        });
        
        console.log('âœ… leadTimes ì—…ë°ì´íŠ¸ ì™„ë£Œ!');
        console.log('ğŸ“Š ìƒˆë¡œìš´ leadTimes:', updatedLeadTimes);
        
        // ê²€ì¦
        const updatedDoc = await chaoranRef.get();
        console.log('ğŸ” ê²€ì¦ ê²°ê³¼:', updatedDoc.data().leadTimes);
        
        result.className = 'result success';
        result.innerHTML = `
          <strong>âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ!</strong><br><br>
          ì± ì˜¤ë€ ìƒì‚°ì—…ì²´ì˜ ë¦¬ë“œíƒ€ì„ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
          <br>
          <strong>ì—…ë°ì´íŠ¸ëœ ë¦¬ë“œíƒ€ì„:</strong>
          <ul style="margin: 10px 0 0 20px;">
            <li>ìì¬: 21ì¼</li>
            <li>í•œë„CFM: 15ì¼</li>
            <li>ì œê°‘&ì¡°ë¦½: 17ì¼</li>
            <li>ê³µì¥ì¶œê³ : 4ì¼</li>
            <li>ì„ ì : 3ì¼</li>
            <li>ì…í•­: 8ì¼</li>
          </ul>
          <br>
          <strong>ë‹¤ìŒ ë‹¨ê³„:</strong><br>
          1. ê¸°ì¡´ ë°ì´í„° ì‚­ì œ (delete-all-data.html)<br>
          2. 10ê±´ Excel ì¬ì—…ë¡œë“œ<br>
          3. ëª©í‘œì¼ í™•ì¸
        `;
        
        btn.textContent = 'âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ!';
        
      } catch (error) {
        console.error('âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
        result.className = 'result error';
        result.innerHTML = `
          <strong>âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨</strong><br><br>
          ${error.message}
        `;
        btn.disabled = false;
        btn.textContent = 'ğŸ”„ ë‹¤ì‹œ ì‹œë„';
      }
    };
  </script>
</body>
</html>
