# 🚀 Firebase Auth 마이그레이션 - 지금 바로 실행!

## ✅ 완료된 작업

- Firebase Admin SDK 설치 완료
- 데이터 분석 스크립트 작성 완료
- 마이그레이션 스크립트 작성 완료
- Git 커밋 완료

---

## 📝 지금 해야 할 일 (단계별)

### 1단계: 서비스 계정 키 다운로드 ⏰ 3분

1. 브라우저에서 Firebase Console 열기: https://console.firebase.google.com
2. **elcanto-scm-portal** 프로젝트 선택
3. 왼쪽 상단 **⚙️ 톱니바퀴** 클릭 → **Project Settings**
4. **Service Accounts** 탭 클릭
5. 아래로 스크롤 → **"Generate new private key"** 버튼 클릭
6. **"Generate key"** 확인
7. 다운로드된 JSON 파일을 찾기
8. 파일명을 **`service-account-key.json`**으로 변경
9. **`Documents\elcanto-scm`** 폴더에 복사

**확인:**
```
Documents\
  └── elcanto-scm\
      ├── service-account-key.json  ← 이 파일이 있어야 함!
      ├── scripts\
      ├── public\
      └── ...
```

---

### 2단계: 데이터 분석 실행 ⏰ 1분

**PowerShell 또는 명령 프롬프트에서:**

```powershell
cd Documents\elcanto-scm
node scripts/analyze-users.js
```

**기대 결과:**
```
✅ Firebase Admin SDK 초기화 완료

📊 Firestore Users 컬렉션 분석 시작
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 총 사용자 수: 28명

📈 분석 결과 요약
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 마이그레이션 가능: 28명
⚠️ 경고 있음: 0명
❌ 오류 있음: 0명
```

**만약 오류가 있다면?**
- 스크립트가 문제가 있는 사용자를 보여줍니다
- 그 사용자의 Firestore 데이터를 수정하세요
- 다시 분석 스크립트를 실행하세요

---

### 3단계: Dry-run 시뮬레이션 ⏰ 1분

**실제 생성 없이 시뮬레이션만 수행 (100% 안전)**

```powershell
node scripts/migrate-auth.js --dry-run
```

**기대 결과:**
```
🧪 DRY-RUN 모드: 실제 생성 없이 시뮬레이션만 수행

[1/28] 처리 중: yang_hyeonguk
   이메일: yang_hyeonguk@elcanto.co.kr
   ✅ [시뮬레이션] 생성 가능: yang_hyeonguk

[2/28] 처리 중: supplier1
   이메일: supplier1@example.com
   ✅ [시뮬레이션] 생성 가능: supplier1

...

✅ 성공: 28명
⚠️ 건너뜀: 0명
❌ 실패: 0명
```

---

### 4단계: 테스트 실행 (1명만) ⏰ 1분

**양형욱 계정 1개만 실제로 생성**

```powershell
node scripts/migrate-auth.js --test
```

**기대 결과:**
```
🧪 TEST 모드: 1명만 테스트 생성

[1/28] 처리 중: yang_hyeonguk
   이메일: yang_hyeonguk@elcanto.co.kr
   🔄 Firebase Auth 사용자 생성 중...
   ✅ 생성 완료! UID: yang_hyeonguk

✅ 성공: 1명
```

**확인:**
1. Firebase Console 열기
2. **Authentication** 메뉴 클릭
3. **Users** 탭에서 `yang_hyeonguk` 확인
4. UID가 `yang_hyeonguk`인지 확인 (중요!)

---

### 5단계: 전체 마이그레이션 실행 ⏰ 2분

**⚠️ 주의: 4단계가 성공했을 때만 진행!**

```powershell
node scripts/migrate-auth.js
```

**기대 결과:**
```
🚀 전체 마이그레이션 실행

[1/28] 처리 중: yang_hyeonguk
   ⚠️ 이미 존재하는 사용자 - 건너뜀

[2/28] 처리 중: supplier1
   ✅ 생성 완료! UID: supplier1

[3/28] 처리 중: supplier2
   ✅ 생성 완료! UID: supplier2

...

✅ 성공: 27명
⚠️ 건너뜀: 1명 (이미 존재)
❌ 실패: 0명
```

**확인:**
- Firebase Console → Authentication → Users
- 28명의 사용자 모두 확인
- 각 UID가 Firestore 문서 ID와 동일한지 확인

---

## 🎉 마이그레이션 완료!

이제 다음 단계로 넘어갑니다:

1. **auth.js 파일 수정** - 익명 로그인을 이메일/비밀번호 로그인으로 변경
2. **배포 및 테스트**

제가 이제 auth.js 파일을 수정하겠습니다!

---

## ❓ 문제가 생겼나요?

### "service-account-key.json 파일이 없습니다"
→ 1단계를 다시 확인하세요. 파일이 `Documents\elcanto-scm` 폴더에 있어야 합니다.

### "permission-denied" 오류
→ Firebase Console에서 서비스 계정 권한을 확인하세요.

### 특정 사용자 생성 실패
→ 스크립트가 이유를 보여줍니다. Firestore에서 해당 사용자 데이터를 수정하세요.

---

## 📞 도움 요청

문제가 해결되지 않으면:
1. 에러 메시지 전체를 복사
2. 실행한 명령어와 함께 공유
3. 제가 도와드리겠습니다!

---

**준비되셨나요? 1단계부터 시작하세요! 🚀**
